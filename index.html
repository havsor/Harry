<!DOCTYPE html>
<html lang="en">
<head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>excel-live-update</title>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
<h2>Upload Excel File</h2>
<input type="file" id="fileInput" accept=".xlsx, .xls">
<div id="output"></div>
<script>
       document.getElementById("fileInput").addEventListener("change", (event) => {
           const file = event.target.files[0];
           const reader = new FileReader();
           reader.onload = (e) => {
               const data = new Uint8Array(e.target.result);
               const workbook = XLSX.read(data, { type: "array" });
               const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
               const sheetData = XLSX.utils.sheet_to_html(firstSheet);
               document.getElementById("output").innerHTML = sheetData;
           };
           reader.readAsArrayBuffer(file);
       });
</script>
</body>
</html>


  <h1>excel-live-update</h1>
  <table id="excelData"></table>

  <script>
    const table = document.getElementById('excelData');

    // Opprett WebSocket-forbindelse
    const socket = new WebSocket('ws://localhost:8080');

    socket.onmessage = function(event) {
      const data = JSON.parse(event.data);
      updateTable(data);
    };

    // Funksjon for Ã¥ oppdatere tabellen med nye data
    function updateTable(data) {
      table.innerHTML = '';

      data.forEach((row, rowIndex) => {
        const rowElement = document.createElement('tr');
        row.forEach(cell => {
          const cellElement = rowIndex === 0 ? document.createElement('th') : document.createElement('td');
          cellElement.textContent = cell || '';
          rowElement.appendChild(cellElement);
        });
        table.appendChild(rowElement);
      });
    }
  </script>
</body>
</html>

